
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

<meta property="og:title" content="9.5.2. Example of explicit fixed effects fMRI model fitting" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://nilearn.github.io/auto_examples/04_glm_first_level/plot_fixed_effects.html" />
  
<meta property="og:site_name" content="Nilearn" />
  
<meta property="og:description" content="This example illustrates how to run a fixed effects model based on pre-computed statistics. This is helpful when the initial models have to be fit separately. For details on the data, please see: D..." />
  
<meta property="og:image" content="https://nilearn.github.io/_static/nilearn-logo.png" />
  
<meta property="og:image:alt" content="Nilearn" />
  
    <title>Nilearn: Statistical Analysis for NeuroImaging in Python &#8212; Machine learning for NeuroImaging</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9.5.3. Default Mode Network extraction of AHDH dataset" href="plot_adhd_dmn.html" />
    <link rel="prev" title="9.5.1. Generate an events.tsv file for the NeuroSpin localizer task" href="plot_write_events_file.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nilearn, neuroimaging, python, neuroscience, machinelearning">


<script type="text/javascript">
function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});
</script>
<script type="text/javascript">
function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head><body>
<div id="logo-banner">
  <div class="logo">
    <a href="../../index.html">
      <img src="../../_static/nilearn-logo.png" alt="Nilearn logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../decoding/plot_haxby_anova_svm.html">SVM</a></big>
    </li>
    <li>
      <small><a href="../../connectivity/parcellating.html">Ward
          clustering</a></small>
    </li>
    <li>
      <a href="../../decoding/searchlight.html">Searchlight</a>
    </li>
    <li>
      <big><a href="../../connectivity/resting_state_networks.html">ICA</a></big>
    </li>
    <li>
      <a href="../../manipulating_images/data_preparation.html">Nifti IO</a>
    </li>
    <li>
      <a href="../../modules/reference.html#module-nilearn.datasets">Datasets</a>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nilearn:</h1>
    <h2>Statistics for NeuroImaging in Python</h2>
  </div>
  <div class="search_form">
    <div class="gcse-search" id="cse" style="width: 100%;"></div>
    <script>
      (function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
  </div>
</div>



<div class=related-wrapper>
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_adhd_dmn.html" title="9.5.3. Default Mode Network extraction of AHDH dataset"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_write_events_file.html" title="9.5.1. Generate an events.tsv file for the NeuroSpin localizer task"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Nilearn Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li><a href="../../glossary.html">Glossary</a>|&nbsp;</li>
<li><a href="../../bibliography.html">Bibliography</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U"><span class="section-number">9. </span>Nilearn usage examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nilearn: Statistical Analysis for NeuroImaging in Python</a></li> 
      </ul>
    </div>
</div>

<div class="devel-alert-banner">
This is documentation for the <em>unstable development version</em> of Nilearn,
the current stable version is available <a href="https://nilearn.github.io/stable/index.html">here</a>.
</div>

  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-04-glm-first-level-plot-fixed-effects-py"><span class="std std-ref">here</span></a>
to download the full example code or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="example-of-explicit-fixed-effects-fmri-model-fitting">
<span id="sphx-glr-auto-examples-04-glm-first-level-plot-fixed-effects-py"></span><h1><span class="section-number">9.5.2. </span>Example of explicit fixed effects fMRI model fitting<a class="headerlink" href="#example-of-explicit-fixed-effects-fmri-model-fitting" title="Permalink to this heading">¶</a></h1>
<p>This example illustrates how to run a fixed effects model based on
pre-computed statistics. This is helpful when the initial models
have to be fit separately.</p>
<p>For details on the data, please see:</p>
<p>Dehaene-Lambertz G, Dehaene S, Anton JL, Campagne A, Ciuciu P, Dehaene
G, Denghien I, Jobert A, LeBihan D, Sigman M, Pallier C, Poline
JB. Functional segregation of cortical language areas by sentence
repetition. Hum Brain Mapp. 2006: 27:360–371.
<a class="reference external" href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11</a></p>
<p>Please see <cite>Simple example of two-session :term:`fMRI</cite> model fitting
&lt;<a class="reference external" href="https://nistats.github.io/auto_examples/02_first_levels/plot_fiac_analysis.html">https://nistats.github.io/auto_examples/02_first_levels/plot_fiac_analysis.html</a>&gt;`_
example for details.  The main difference is that
the fixed-effects model is run explicitly here,
after GLM fitting on two sessions.</p>
<section id="prepare-data-and-analysis-parameters">
<h2><span class="section-number">9.5.2.1. </span>Prepare data and analysis parameters<a class="headerlink" href="#prepare-data-and-analysis-parameters" title="Permalink to this heading">¶</a></h2>
<p>Inspecting ‘data’, we note that there are two sessions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.datasets</span> <span class="kn">import</span> <span class="n">func</span>
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.datasets.fetch_fiac_first_level.html#nilearn.datasets.fetch_fiac_first_level" title="nilearn.datasets.fetch_fiac_first_level" class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"><span class="n">func</span><span class="o">.</span><span class="n">fetch_fiac_first_level</span></a><span class="p">()</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;func1&#39;</span><span class="p">],</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;func2&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Dataset created in /home/circleci/nilearn_data/fiac_nilearn.glm

Missing functional scan for session 1.
Data absent, downloading...
Downloading data from http://nipy.sourceforge.net/data-packages/nipy-data-0.2.tar.gz ...

Downloaded 2105344 of 81515168 bytes (2.6%,  1.5min remaining)
Downloaded 2629632 of 81515168 bytes (3.2%,  1.7min remaining)
Downloaded 3153920 of 81515168 bytes (3.9%,  1.8min remaining)
Downloaded 3956736 of 81515168 bytes (4.9%,  1.7min remaining)
Downloaded 4472832 of 81515168 bytes (5.5%,  1.8min remaining)
Downloaded 4726784 of 81515168 bytes (5.8%,  2.0min remaining)
Downloaded 5439488 of 81515168 bytes (6.7%,  1.9min remaining)
Downloaded 6062080 of 81515168 bytes (7.4%,  1.9min remaining)
Downloaded 6348800 of 81515168 bytes (7.8%,  2.0min remaining)
Downloaded 6823936 of 81515168 bytes (8.4%,  2.1min remaining)
Downloaded 7413760 of 81515168 bytes (9.1%,  2.1min remaining)
Downloaded 8224768 of 81515168 bytes (10.1%,  2.0min remaining)
Downloaded 8626176 of 81515168 bytes (10.6%,  2.0min remaining)
Downloaded 9199616 of 81515168 bytes (11.3%,  2.0min remaining)
Downloaded 9797632 of 81515168 bytes (12.0%,  2.0min remaining)
Downloaded 10182656 of 81515168 bytes (12.5%,  2.0min remaining)
Downloaded 10862592 of 81515168 bytes (13.3%,  2.0min remaining)
Downloaded 11198464 of 81515168 bytes (13.7%,  2.0min remaining)
Downloaded 11976704 of 81515168 bytes (14.7%,  2.0min remaining)
Downloaded 12591104 of 81515168 bytes (15.4%,  2.0min remaining)
Downloaded 13115392 of 81515168 bytes (16.1%,  2.0min remaining)
Downloaded 13721600 of 81515168 bytes (16.8%,  2.0min remaining)
Downloaded 14385152 of 81515168 bytes (17.6%,  2.0min remaining)
Downloaded 14942208 of 81515168 bytes (18.3%,  2.0min remaining)
Downloaded 15523840 of 81515168 bytes (19.0%,  1.9min remaining)
Downloaded 15769600 of 81515168 bytes (19.3%,  2.0min remaining)
Downloaded 16785408 of 81515168 bytes (20.6%,  1.9min remaining)
Downloaded 17309696 of 81515168 bytes (21.2%,  1.9min remaining)
Downloaded 17833984 of 81515168 bytes (21.9%,  1.9min remaining)
Downloaded 18472960 of 81515168 bytes (22.7%,  1.9min remaining)
Downloaded 19316736 of 81515168 bytes (23.7%,  1.8min remaining)
Downloaded 19611648 of 81515168 bytes (24.1%,  1.9min remaining)
Downloaded 20045824 of 81515168 bytes (24.6%,  1.9min remaining)
Downloaded 20455424 of 81515168 bytes (25.1%,  1.9min remaining)
Downloaded 20979712 of 81515168 bytes (25.7%,  1.8min remaining)
Downloaded 21504000 of 81515168 bytes (26.4%,  1.8min remaining)
Downloaded 22052864 of 81515168 bytes (27.1%,  1.8min remaining)
Downloaded 22732800 of 81515168 bytes (27.9%,  1.8min remaining)
Downloaded 23232512 of 81515168 bytes (28.5%,  1.8min remaining)
Downloaded 23928832 of 81515168 bytes (29.4%,  1.7min remaining)
Downloaded 24182784 of 81515168 bytes (29.7%,  1.8min remaining)
Downloaded 24870912 of 81515168 bytes (30.5%,  1.7min remaining)
Downloaded 25387008 of 81515168 bytes (31.1%,  1.7min remaining)
Downloaded 25812992 of 81515168 bytes (31.7%,  1.7min remaining)
Downloaded 26492928 of 81515168 bytes (32.5%,  1.7min remaining)
Downloaded 26902528 of 81515168 bytes (33.0%,  1.7min remaining)
Downloaded 27435008 of 81515168 bytes (33.7%,  1.7min remaining)
Downloaded 28213248 of 81515168 bytes (34.6%,  1.6min remaining)
Downloaded 28688384 of 81515168 bytes (35.2%,  1.6min remaining)
Downloaded 28934144 of 81515168 bytes (35.5%,  1.6min remaining)
Downloaded 29679616 of 81515168 bytes (36.4%,  1.6min remaining)
Downloaded 29900800 of 81515168 bytes (36.7%,  1.6min remaining)
Downloaded 30793728 of 81515168 bytes (37.8%,  1.5min remaining)
Downloaded 31211520 of 81515168 bytes (38.3%,  1.5min remaining)
Downloaded 31744000 of 81515168 bytes (38.9%,  1.5min remaining)
Downloaded 32169984 of 81515168 bytes (39.5%,  1.5min remaining)
Downloaded 32808960 of 81515168 bytes (40.2%,  1.5min remaining)
Downloaded 33251328 of 81515168 bytes (40.8%,  1.5min remaining)
Downloaded 34086912 of 81515168 bytes (41.8%,  1.5min remaining)
Downloaded 34611200 of 81515168 bytes (42.5%,  1.5min remaining)
Downloaded 35332096 of 81515168 bytes (43.3%,  1.4min remaining)
Downloaded 35971072 of 81515168 bytes (44.1%,  1.4min remaining)
Downloaded 36315136 of 81515168 bytes (44.6%,  1.4min remaining)
Downloaded 36880384 of 81515168 bytes (45.2%,  1.4min remaining)
Downloaded 37322752 of 81515168 bytes (45.8%,  1.4min remaining)
Downloaded 37928960 of 81515168 bytes (46.5%,  1.3min remaining)
Downloaded 38379520 of 81515168 bytes (47.1%,  1.3min remaining)
Downloaded 38985728 of 81515168 bytes (47.8%,  1.3min remaining)
Downloaded 39542784 of 81515168 bytes (48.5%,  1.3min remaining)
Downloaded 40239104 of 81515168 bytes (49.4%,  1.3min remaining)
Downloaded 40656896 of 81515168 bytes (49.9%,  1.3min remaining)
Downloaded 41091072 of 81515168 bytes (50.4%,  1.3min remaining)
Downloaded 41615360 of 81515168 bytes (51.1%,  1.2min remaining)
Downloaded 42188800 of 81515168 bytes (51.8%,  1.2min remaining)
Downloaded 42942464 of 81515168 bytes (52.7%,  1.2min remaining)
Downloaded 43270144 of 81515168 bytes (53.1%,  1.2min remaining)
Downloaded 43819008 of 81515168 bytes (53.8%,  1.2min remaining)
Downloaded 44228608 of 81515168 bytes (54.3%,  1.2min remaining)
Downloaded 44826624 of 81515168 bytes (55.0%,  1.1min remaining)
Downloaded 45318144 of 81515168 bytes (55.6%,  1.1min remaining)
Downloaded 45793280 of 81515168 bytes (56.2%,  1.1min remaining)
Downloaded 46268416 of 81515168 bytes (56.8%,  1.1min remaining)
Downloaded 46669824 of 81515168 bytes (57.3%,  1.1min remaining)
Downloaded 47284224 of 81515168 bytes (58.0%,  1.1min remaining)
Downloaded 47857664 of 81515168 bytes (58.7%,  1.0min remaining)
Downloaded 48291840 of 81515168 bytes (59.2%,  1.0min remaining)
Downloaded 48783360 of 81515168 bytes (59.8%,  1.0min remaining)
Downloaded 49487872 of 81515168 bytes (60.7%,   59.8s remaining)
Downloaded 50126848 of 81515168 bytes (61.5%,   58.5s remaining)
Downloaded 50339840 of 81515168 bytes (61.8%,   58.4s remaining)
Downloaded 51142656 of 81515168 bytes (62.7%,   56.6s remaining)
Downloaded 51396608 of 81515168 bytes (63.1%,   56.5s remaining)
Downloaded 51994624 of 81515168 bytes (63.8%,   55.3s remaining)
Downloaded 52436992 of 81515168 bytes (64.3%,   54.5s remaining)
Downloaded 53051392 of 81515168 bytes (65.1%,   53.3s remaining)
Downloaded 53518336 of 81515168 bytes (65.7%,   52.5s remaining)
Downloaded 54075392 of 81515168 bytes (66.3%,   51.4s remaining)
Downloaded 54624256 of 81515168 bytes (67.0%,   50.4s remaining)
Downloaded 55271424 of 81515168 bytes (67.8%,   49.1s remaining)
Downloaded 55795712 of 81515168 bytes (68.4%,   48.1s remaining)
Downloaded 56246272 of 81515168 bytes (69.0%,   47.3s remaining)
Downloaded 56852480 of 81515168 bytes (69.7%,   46.1s remaining)
Downloaded 57376768 of 81515168 bytes (70.4%,   45.2s remaining)
Downloaded 57892864 of 81515168 bytes (71.0%,   44.2s remaining)
Downloaded 58343424 of 81515168 bytes (71.6%,   43.4s remaining)
Downloaded 58793984 of 81515168 bytes (72.1%,   42.6s remaining)
Downloaded 59432960 of 81515168 bytes (72.9%,   41.4s remaining)
Downloaded 60096512 of 81515168 bytes (73.7%,   40.0s remaining)
Downloaded 60432384 of 81515168 bytes (74.1%,   39.5s remaining)
Downloaded 60956672 of 81515168 bytes (74.8%,   38.6s remaining)
Downloaded 61530112 of 81515168 bytes (75.5%,   37.5s remaining)
Downloaded 62193664 of 81515168 bytes (76.3%,   36.1s remaining)
Downloaded 62578688 of 81515168 bytes (76.8%,   35.5s remaining)
Downloaded 63291392 of 81515168 bytes (77.6%,   34.1s remaining)
Downloaded 63971328 of 81515168 bytes (78.5%,   33.0s remaining)
Downloaded 64495616 of 81515168 bytes (79.1%,   32.0s remaining)
Downloaded 65044480 of 81515168 bytes (79.8%,   31.0s remaining)
Downloaded 65691648 of 81515168 bytes (80.6%,   29.7s remaining)
Downloaded 66199552 of 81515168 bytes (81.2%,   28.8s remaining)
Downloaded 66797568 of 81515168 bytes (81.9%,   27.6s remaining)
Downloaded 67248128 of 81515168 bytes (82.5%,   26.8s remaining)
Downloaded 67756032 of 81515168 bytes (83.1%,   25.9s remaining)
Downloaded 68395008 of 81515168 bytes (83.9%,   24.6s remaining)
Downloaded 68788224 of 81515168 bytes (84.4%,   23.9s remaining)
Downloaded 69386240 of 81515168 bytes (85.1%,   22.8s remaining)
Downloaded 69795840 of 81515168 bytes (85.6%,   22.1s remaining)
Downloaded 70541312 of 81515168 bytes (86.5%,   20.6s remaining)
Downloaded 70942720 of 81515168 bytes (87.0%,   19.9s remaining)
Downloaded 71598080 of 81515168 bytes (87.8%,   18.6s remaining)
Downloaded 72204288 of 81515168 bytes (88.6%,   17.5s remaining)
Downloaded 72556544 of 81515168 bytes (89.0%,   16.8s remaining)
Downloaded 73023488 of 81515168 bytes (89.6%,   16.0s remaining)
Downloaded 73662464 of 81515168 bytes (90.4%,   14.7s remaining)
Downloaded 73965568 of 81515168 bytes (90.7%,   14.2s remaining)
Downloaded 74760192 of 81515168 bytes (91.7%,   12.7s remaining)
Downloaded 75292672 of 81515168 bytes (92.4%,   11.7s remaining)
Downloaded 75784192 of 81515168 bytes (93.0%,   10.8s remaining)
Downloaded 76324864 of 81515168 bytes (93.6%,    9.7s remaining)
Downloaded 76791808 of 81515168 bytes (94.2%,    8.9s remaining)
Downloaded 77504512 of 81515168 bytes (95.1%,    7.5s remaining)
Downloaded 78028800 of 81515168 bytes (95.7%,    6.5s remaining)
Downloaded 78561280 of 81515168 bytes (96.4%,    5.5s remaining)
Downloaded 79175680 of 81515168 bytes (97.1%,    4.4s remaining)
Downloaded 79912960 of 81515168 bytes (98.0%,    3.0s remaining)
Downloaded 80445440 of 81515168 bytes (98.7%,    2.0s remaining)
Downloaded 80805888 of 81515168 bytes (99.1%,    1.3s remaining)
Downloaded 81485824 of 81515168 bytes (100.0%,    0.1s remaining) ...done. (154 seconds, 2 min)
Extracting data from /home/circleci/nilearn_data/fiac_nilearn.glm/nipy-data-0.2.tar.gz..... done.
</pre></div>
</div>
<p>Create a mean image for plotting purpose</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img" title="nilearn.image.mean_img" class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"><span class="n">mean_img</span></a>
<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img" title="nilearn.image.mean_img" class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"><span class="n">mean_img</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>The design matrices were pre-computed, we simply put them in a list of
DataFrames</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_files</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;design_matrix1&#39;</span><span class="p">],</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;design_matrix2&#39;</span><span class="p">]]</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class"><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="numpy.load" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="n">df</span><span class="p">)[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_files</span></a><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="glm-estimation">
<h2><span class="section-number">9.5.2.2. </span>GLM estimation<a class="headerlink" href="#glm-estimation" title="Permalink to this heading">¶</a></h2>
<p>GLM specification. Note that the mask was provided in the dataset.
So we use it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"><span class="n">FirstLevelModel</span></a>
<a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"><span class="n">FirstLevelModel</span></a><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">],</span> <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                           <span class="n">minimize_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute fixed effects of the two runs and compute related images
For this, we first define the contrasts as we would do for a single session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3.8/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a> <span class="o">=</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_val</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack" title="numpy.hstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">(([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a> <span class="o">-</span> <span class="mi">4</span><span class="p">)))</span>
</pre></div>
</div>
<p>Statistics for the first session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">129</span><span class="p">,</span> <span class="o">-</span><span class="mi">126</span><span class="p">,</span> <span class="mi">49</span><span class="p">]</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a> <span class="o">=</span> <span class="s1">&#39;DSt_minus_SSt&#39;</span>

<a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit" title="nilearn.glm.first_level.FirstLevelModel.fit" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.compute_contrast" title="nilearn.glm.first_level.FirstLevelModel.compute_contrast" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">compute_contrast</span></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_val</span></a><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">],</span>
    <span class="n">bg_img</span><span class="o">=</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, first session&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_fixed_effects_001.png" srcset="../../_images/sphx_glr_plot_fixed_effects_001.png" alt="plot fixed effects" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7fa757e67f40&gt;
</pre></div>
</div>
<p>Statistics for the second session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit" title="nilearn.glm.first_level.FirstLevelModel.fit" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.compute_contrast" title="nilearn.glm.first_level.FirstLevelModel.compute_contrast" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">compute_contrast</span></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_val</span></a><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">],</span>
    <span class="n">bg_img</span><span class="o">=</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, second session&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_fixed_effects_002.png" srcset="../../_images/sphx_glr_plot_fixed_effects_002.png" alt="plot fixed effects" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7fa7567b8760&gt;
</pre></div>
</div>
<p>Fixed effects statistics</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm.contrasts</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.glm.compute_fixed_effects.html#nilearn.glm.compute_fixed_effects" title="nilearn.glm.compute_fixed_effects" class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"><span class="n">compute_fixed_effects</span></a>

<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_imgs</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;effect_size&#39;</span><span class="p">],</span>
                 <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;effect_size&#39;</span><span class="p">]]</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variance_imgs</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;effect_variance&#39;</span><span class="p">],</span>
                 <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;effect_variance&#39;</span><span class="p">]]</span>

<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_contrast</span></a><span class="p">,</span> <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_variance</span></a><span class="p">,</span> <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_stat</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.compute_fixed_effects.html#nilearn.glm.compute_fixed_effects" title="nilearn.glm.compute_fixed_effects" class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"><span class="n">compute_fixed_effects</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_imgs</span></a><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variance_imgs</span></a><span class="p">,</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">])</span>
<a href="../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_stat</span></a><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, fixed effects&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_fixed_effects_003.png" srcset="../../_images/sphx_glr_plot_fixed_effects_003.png" alt="plot fixed effects" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7fa756612640&gt;
</pre></div>
</div>
<p>Not unexpectedly, the fixed effects version displays higher peaks than the
input sessions. Computing fixed effects enhances the signal-to-noise ratio of
the resulting brain maps
Note however that, technically, the output maps of the fixed effects map is a
t statistic (not a z statistic)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show" title="nilearn.plotting.show" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 2 minutes  43.827 seconds)</p>
<p><strong>Estimated memory usage:</strong>  568 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-04-glm-first-level-plot-fixed-effects-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/nilearn/nilearn.github.io/main?filepath=examples/auto_examples/04_glm_first_level/plot_fixed_effects.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo3.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d2b4e3e9a76e840cd4c542019b17053c/plot_fixed_effects.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_fixed_effects.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/30c60aaeed5034b71966151d9b233e9c/plot_fixed_effects.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_fixed_effects.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">9.5.2. Example of explicit fixed effects fMRI model fitting</a><ul>
<li><a class="reference internal" href="#prepare-data-and-analysis-parameters">9.5.2.1. Prepare data and analysis parameters</a></li>
<li><a class="reference internal" href="#glm-estimation">9.5.2.2. GLM estimation</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_write_events_file.html"
                          title="previous chapter"><span class="section-number">9.5.1. </span>Generate an events.tsv file for the NeuroSpin localizer task</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_adhd_dmn.html"
                          title="next chapter"><span class="section-number">9.5.3. </span>Default Mode Network extraction of AHDH dataset</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
            &copy; The nilearn developers 2010-2022.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 5.0.1.
        <span style="padding-left: 5ex;">
          <a href="../../_sources/auto_examples/04_glm_first_level/plot_fixed_effects.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>