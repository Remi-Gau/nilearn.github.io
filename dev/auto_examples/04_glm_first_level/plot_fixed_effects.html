
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

<meta property="og:title" content="9.5.2. Example of explicit fixed effects fMRI model fitting" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://nilearn.github.io/auto_examples/04_glm_first_level/plot_fixed_effects.html" />
  
<meta property="og:site_name" content="Nilearn" />
  
<meta property="og:description" content="This example illustrates how to run a fixed effects model based on pre-computed statistics. This is helpful when the initial models have to be fit separately. For details on the data, please see: D..." />
  
<meta property="og:image" content="https://nilearn.github.io/_static/nilearn-logo.png" />
  
<meta property="og:image:alt" content="Nilearn" />
  
    <title>Nilearn: Statistical Analysis for NeuroImaging in Python &#8212; Machine learning for NeuroImaging</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9.5.3. Default Mode Network extraction of AHDH dataset" href="plot_adhd_dmn.html" />
    <link rel="prev" title="9.5.1. Generate an events.tsv file for the NeuroSpin localizer task" href="plot_write_events_file.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nilearn, neuroimaging, python, neuroscience, machinelearning">


<script type="text/javascript">
function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});
</script>
<script type="text/javascript">
function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head><body>
<div id="logo-banner">
  <div class="logo">
    <a href="../../index.html">
      <img src="../../_static/nilearn-logo.png" alt="Nilearn logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../decoding/plot_haxby_anova_svm.html">SVM</a></big>
    </li>
    <li>
      <small><a href="../../connectivity/parcellating.html">Ward
          clustering</a></small>
    </li>
    <li>
      <a href="../../decoding/searchlight.html">Searchlight</a>
    </li>
    <li>
      <big><a href="../../connectivity/resting_state_networks.html">ICA</a></big>
    </li>
    <li>
      <a href="../../manipulating_images/data_preparation.html">Nifti IO</a>
    </li>
    <li>
      <a href="../../modules/reference.html#module-nilearn.datasets">Datasets</a>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nilearn:</h1>
    <h2>Statistics for NeuroImaging in Python</h2>
  </div>
  <div class="search_form">
    <div class="gcse-search" id="cse" style="width: 100%;"></div>
    <script>
      (function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
  </div>
</div>



<div class=related-wrapper>
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_adhd_dmn.html" title="9.5.3. Default Mode Network extraction of AHDH dataset"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_write_events_file.html" title="9.5.1. Generate an events.tsv file for the NeuroSpin localizer task"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Nilearn Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li><a href="../../glossary.html">Glossary</a>|&nbsp;</li>
<li><a href="../../bibliography.html">Bibliography</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U"><span class="section-number">9. </span>Nilearn usage examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nilearn: Statistical Analysis for NeuroImaging in Python</a></li> 
      </ul>
    </div>
</div>

<div class="devel-alert-banner">
This is documentation for the <em>unstable development version</em> of Nilearn,
the current stable version is available <a href="https://nilearn.github.io/stable/index.html">here</a>.
</div>

  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-04-glm-first-level-plot-fixed-effects-py"><span class="std std-ref">here</span></a>
to download the full example code or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="example-of-explicit-fixed-effects-fmri-model-fitting">
<span id="sphx-glr-auto-examples-04-glm-first-level-plot-fixed-effects-py"></span><h1><span class="section-number">9.5.2. </span>Example of explicit fixed effects fMRI model fitting<a class="headerlink" href="#example-of-explicit-fixed-effects-fmri-model-fitting" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates how to run a fixed effects model based on
pre-computed statistics. This is helpful when the initial models
have to be fit separately.</p>
<p>For details on the data, please see:</p>
<p>Dehaene-Lambertz G, Dehaene S, Anton JL, Campagne A, Ciuciu P, Dehaene
G, Denghien I, Jobert A, LeBihan D, Sigman M, Pallier C, Poline
JB. Functional segregation of cortical language areas by sentence
repetition. Hum Brain Mapp. 2006: 27:360–371.
<a class="reference external" href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11</a></p>
<p>Please see <cite>Simple example of two-session :term:`fMRI</cite> model fitting
&lt;<a class="reference external" href="https://nistats.github.io/auto_examples/02_first_levels/plot_fiac_analysis.html">https://nistats.github.io/auto_examples/02_first_levels/plot_fiac_analysis.html</a>&gt;`_
example for details.  The main difference is that
the fixed-effects model is run explicitly here,
after GLM fitting on two sessions.</p>
<section id="prepare-data-and-analysis-parameters">
<h2><span class="section-number">9.5.2.1. </span>Prepare data and analysis parameters<a class="headerlink" href="#prepare-data-and-analysis-parameters" title="Permalink to this headline">¶</a></h2>
<p>Inspecting ‘data’, we note that there are two sessions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.datasets</span> <span class="kn">import</span> <span class="n">func</span>
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.datasets.fetch_fiac_first_level.html#nilearn.datasets.fetch_fiac_first_level" title="nilearn.datasets.fetch_fiac_first_level" class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"><span class="n">func</span><span class="o">.</span><span class="n">fetch_fiac_first_level</span></a><span class="p">()</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;func1&#39;</span><span class="p">],</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;func2&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Dataset created in /home/circleci/nilearn_data/fiac_nilearn.glm

Missing functional scan for session 1.
Data absent, downloading...
Downloading data from http://nipy.sourceforge.net/data-packages/nipy-data-0.2.tar.gz ...

Downloaded 524288 of 81515168 bytes (0.6%,  2.6min remaining)
Downloaded 958464 of 81515168 bytes (1.2%,  3.3min remaining)
Downloaded 1155072 of 81515168 bytes (1.4%,  5.5min remaining)
Downloaded 1310720 of 81515168 bytes (1.6%,  5.9min remaining)
Downloaded 1327104 of 81515168 bytes (1.6%,  6.9min remaining)
Downloaded 1466368 of 81515168 bytes (1.8%,  7.2min remaining)
Downloaded 1671168 of 81515168 bytes (2.1%,  7.2min remaining)
Downloaded 2203648 of 81515168 bytes (2.7%,  6.1min remaining)
Downloaded 2801664 of 81515168 bytes (3.4%,  5.3min remaining)
Downloaded 3293184 of 81515168 bytes (4.0%,  4.9min remaining)
Downloaded 3588096 of 81515168 bytes (4.4%,  4.9min remaining)
Downloaded 3932160 of 81515168 bytes (4.8%,  4.8min remaining)
Downloaded 4399104 of 81515168 bytes (5.4%,  4.6min remaining)
Downloaded 4472832 of 81515168 bytes (5.5%,  4.9min remaining)
Downloaded 4571136 of 81515168 bytes (5.6%,  5.2min remaining)
Downloaded 5005312 of 81515168 bytes (6.1%,  5.0min remaining)
Downloaded 5152768 of 81515168 bytes (6.3%,  5.2min remaining)
Downloaded 5529600 of 81515168 bytes (6.8%,  5.0min remaining)
Downloaded 5701632 of 81515168 bytes (7.0%,  5.1min remaining)
Downloaded 5898240 of 81515168 bytes (7.2%,  5.2min remaining)
Downloaded 6176768 of 81515168 bytes (7.6%,  5.2min remaining)
Downloaded 6815744 of 81515168 bytes (8.4%,  4.9min remaining)
Downloaded 6979584 of 81515168 bytes (8.6%,  5.0min remaining)
Downloaded 7307264 of 81515168 bytes (9.0%,  5.0min remaining)
Downloaded 7831552 of 81515168 bytes (9.6%,  4.8min remaining)
Downloaded 8159232 of 81515168 bytes (10.0%,  4.9min remaining)
Downloaded 8454144 of 81515168 bytes (10.4%,  4.9min remaining)
Downloaded 8921088 of 81515168 bytes (10.9%,  4.7min remaining)
Downloaded 9289728 of 81515168 bytes (11.4%,  4.7min remaining)
Downloaded 9560064 of 81515168 bytes (11.7%,  4.7min remaining)
Downloaded 9732096 of 81515168 bytes (11.9%,  4.7min remaining)
Downloaded 9928704 of 81515168 bytes (12.2%,  4.8min remaining)
Downloaded 10051584 of 81515168 bytes (12.3%,  4.8min remaining)
Downloaded 10534912 of 81515168 bytes (12.9%,  4.7min remaining)
Downloaded 10715136 of 81515168 bytes (13.1%,  4.8min remaining)
Downloaded 11157504 of 81515168 bytes (13.7%,  4.8min remaining)
Downloaded 11419648 of 81515168 bytes (14.0%,  4.7min remaining)
Downloaded 11575296 of 81515168 bytes (14.2%,  4.8min remaining)
Downloaded 11747328 of 81515168 bytes (14.4%,  4.9min remaining)
Downloaded 12255232 of 81515168 bytes (15.0%,  4.8min remaining)
Downloaded 12460032 of 81515168 bytes (15.3%,  4.8min remaining)
Downloaded 12730368 of 81515168 bytes (15.6%,  4.8min remaining)
Downloaded 12779520 of 81515168 bytes (15.7%,  4.9min remaining)
Downloaded 13049856 of 81515168 bytes (16.0%,  4.9min remaining)
Downloaded 13516800 of 81515168 bytes (16.6%,  4.8min remaining)
Downloaded 14057472 of 81515168 bytes (17.2%,  4.7min remaining)
Downloaded 14376960 of 81515168 bytes (17.6%,  4.6min remaining)
Downloaded 14794752 of 81515168 bytes (18.1%,  4.6min remaining)
Downloaded 14893056 of 81515168 bytes (18.3%,  4.7min remaining)
Downloaded 15130624 of 81515168 bytes (18.6%,  4.7min remaining)
Downloaded 15335424 of 81515168 bytes (18.8%,  4.7min remaining)
Downloaded 15433728 of 81515168 bytes (18.9%,  4.7min remaining)
Downloaded 16023552 of 81515168 bytes (19.7%,  4.6min remaining)
Downloaded 16646144 of 81515168 bytes (20.4%,  4.5min remaining)
Downloaded 17104896 of 81515168 bytes (21.0%,  4.4min remaining)
Downloaded 17301504 of 81515168 bytes (21.2%,  4.4min remaining)
Downloaded 17547264 of 81515168 bytes (21.5%,  4.4min remaining)
Downloaded 17694720 of 81515168 bytes (21.7%,  4.4min remaining)
Downloaded 17776640 of 81515168 bytes (21.8%,  4.6min remaining)
Downloaded 18358272 of 81515168 bytes (22.5%,  4.5min remaining)
Downloaded 18849792 of 81515168 bytes (23.1%,  4.4min remaining)
Downloaded 19259392 of 81515168 bytes (23.6%,  4.3min remaining)
Downloaded 19447808 of 81515168 bytes (23.9%,  4.3min remaining)
Downloaded 19554304 of 81515168 bytes (24.0%,  4.3min remaining)
Downloaded 19701760 of 81515168 bytes (24.2%,  4.4min remaining)
Downloaded 19890176 of 81515168 bytes (24.4%,  4.4min remaining)
Downloaded 20070400 of 81515168 bytes (24.6%,  4.4min remaining)
Downloaded 20283392 of 81515168 bytes (24.9%,  4.4min remaining)
Downloaded 20676608 of 81515168 bytes (25.4%,  4.3min remaining)
Downloaded 20791296 of 81515168 bytes (25.5%,  4.3min remaining)
Downloaded 21315584 of 81515168 bytes (26.1%,  4.2min remaining)
Downloaded 21569536 of 81515168 bytes (26.5%,  4.3min remaining)
Downloaded 21700608 of 81515168 bytes (26.6%,  4.3min remaining)
Downloaded 22110208 of 81515168 bytes (27.1%,  4.3min remaining)
Downloaded 22167552 of 81515168 bytes (27.2%,  4.3min remaining)
Downloaded 22257664 of 81515168 bytes (27.3%,  4.3min remaining)
Downloaded 22413312 of 81515168 bytes (27.5%,  4.3min remaining)
Downloaded 22904832 of 81515168 bytes (28.1%,  4.3min remaining)
Downloaded 23527424 of 81515168 bytes (28.9%,  4.2min remaining)
Downloaded 24084480 of 81515168 bytes (29.5%,  4.1min remaining)
Downloaded 24248320 of 81515168 bytes (29.7%,  4.1min remaining)
Downloaded 24379392 of 81515168 bytes (29.9%,  4.1min remaining)
Downloaded 24707072 of 81515168 bytes (30.3%,  4.1min remaining)
Downloaded 25255936 of 81515168 bytes (31.0%,  4.0min remaining)
Downloaded 25952256 of 81515168 bytes (31.8%,  3.9min remaining)
Downloaded 26345472 of 81515168 bytes (32.3%,  3.8min remaining)
Downloaded 26755072 of 81515168 bytes (32.8%,  3.8min remaining)
Downloaded 27017216 of 81515168 bytes (33.1%,  3.8min remaining)
Downloaded 27541504 of 81515168 bytes (33.8%,  3.7min remaining)
Downloaded 28229632 of 81515168 bytes (34.6%,  3.6min remaining)
Downloaded 28827648 of 81515168 bytes (35.4%,  3.5min remaining)
Downloaded 29040640 of 81515168 bytes (35.6%,  3.5min remaining)
Downloaded 29245440 of 81515168 bytes (35.9%,  3.5min remaining)
Downloaded 29614080 of 81515168 bytes (36.3%,  3.5min remaining)
Downloaded 30113792 of 81515168 bytes (36.9%,  3.4min remaining)
Downloaded 30375936 of 81515168 bytes (37.3%,  3.4min remaining)
Downloaded 30523392 of 81515168 bytes (37.4%,  3.4min remaining)
Downloaded 30965760 of 81515168 bytes (38.0%,  3.3min remaining)
Downloaded 31113216 of 81515168 bytes (38.2%,  3.3min remaining)
Downloaded 31334400 of 81515168 bytes (38.4%,  3.3min remaining)
Downloaded 31719424 of 81515168 bytes (38.9%,  3.3min remaining)
Downloaded 32661504 of 81515168 bytes (40.1%,  3.2min remaining)
Downloaded 33325056 of 81515168 bytes (40.9%,  3.1min remaining)
Downloaded 33751040 of 81515168 bytes (41.4%,  3.1min remaining)
Downloaded 34013184 of 81515168 bytes (41.7%,  3.1min remaining)
Downloaded 34177024 of 81515168 bytes (41.9%,  3.1min remaining)
Downloaded 34308096 of 81515168 bytes (42.1%,  3.1min remaining)
Downloaded 34455552 of 81515168 bytes (42.3%,  3.1min remaining)
Downloaded 34652160 of 81515168 bytes (42.5%,  3.1min remaining)
Downloaded 35086336 of 81515168 bytes (43.0%,  3.1min remaining)
Downloaded 35536896 of 81515168 bytes (43.6%,  3.0min remaining)
Downloaded 35930112 of 81515168 bytes (44.1%,  3.0min remaining)
Downloaded 36454400 of 81515168 bytes (44.7%,  2.9min remaining)
Downloaded 36798464 of 81515168 bytes (45.1%,  2.9min remaining)
Downloaded 37060608 of 81515168 bytes (45.5%,  2.9min remaining)
Downloaded 37232640 of 81515168 bytes (45.7%,  2.9min remaining)
Downloaded 37388288 of 81515168 bytes (45.9%,  2.9min remaining)
Downloaded 37683200 of 81515168 bytes (46.2%,  2.9min remaining)
Downloaded 38133760 of 81515168 bytes (46.8%,  2.8min remaining)
Downloaded 38379520 of 81515168 bytes (47.1%,  2.8min remaining)
Downloaded 38436864 of 81515168 bytes (47.2%,  2.8min remaining)
Downloaded 38617088 of 81515168 bytes (47.4%,  2.8min remaining)
Downloaded 39100416 of 81515168 bytes (48.0%,  2.8min remaining)
Downloaded 39813120 of 81515168 bytes (48.8%,  2.7min remaining)
Downloaded 40230912 of 81515168 bytes (49.4%,  2.7min remaining)
Downloaded 40337408 of 81515168 bytes (49.5%,  2.7min remaining)
Downloaded 40796160 of 81515168 bytes (50.0%,  2.7min remaining)
Downloaded 41140224 of 81515168 bytes (50.5%,  2.6min remaining)
Downloaded 41484288 of 81515168 bytes (50.9%,  2.6min remaining)
Downloaded 41820160 of 81515168 bytes (51.3%,  2.6min remaining)
Downloaded 42049536 of 81515168 bytes (51.6%,  2.6min remaining)
Downloaded 42541056 of 81515168 bytes (52.2%,  2.5min remaining)
Downloaded 42737664 of 81515168 bytes (52.4%,  2.5min remaining)
Downloaded 43106304 of 81515168 bytes (52.9%,  2.5min remaining)
Downloaded 43687936 of 81515168 bytes (53.6%,  2.4min remaining)
Downloaded 43917312 of 81515168 bytes (53.9%,  2.4min remaining)
Downloaded 43982848 of 81515168 bytes (54.0%,  2.4min remaining)
Downloaded 44244992 of 81515168 bytes (54.3%,  2.4min remaining)
Downloaded 44433408 of 81515168 bytes (54.5%,  2.4min remaining)
Downloaded 44580864 of 81515168 bytes (54.7%,  2.4min remaining)
Downloaded 44654592 of 81515168 bytes (54.8%,  2.4min remaining)
Downloaded 44728320 of 81515168 bytes (54.9%,  2.5min remaining)
Downloaded 44974080 of 81515168 bytes (55.2%,  2.4min remaining)
Downloaded 45604864 of 81515168 bytes (55.9%,  2.4min remaining)
Downloaded 45940736 of 81515168 bytes (56.4%,  2.4min remaining)
Downloaded 46243840 of 81515168 bytes (56.7%,  2.4min remaining)
Downloaded 46587904 of 81515168 bytes (57.2%,  2.3min remaining)
Downloaded 46743552 of 81515168 bytes (57.3%,  2.3min remaining)
Downloaded 47161344 of 81515168 bytes (57.9%,  2.3min remaining)
Downloaded 47669248 of 81515168 bytes (58.5%,  2.2min remaining)
Downloaded 47800320 of 81515168 bytes (58.6%,  2.2min remaining)
Downloaded 47972352 of 81515168 bytes (58.9%,  2.2min remaining)
Downloaded 48070656 of 81515168 bytes (59.0%,  2.2min remaining)
Downloaded 48218112 of 81515168 bytes (59.2%,  2.2min remaining)
Downloaded 48594944 of 81515168 bytes (59.6%,  2.2min remaining)
Downloaded 49274880 of 81515168 bytes (60.4%,  2.1min remaining)
Downloaded 49790976 of 81515168 bytes (61.1%,  2.1min remaining)
Downloaded 50167808 of 81515168 bytes (61.5%,  2.1min remaining)
Downloaded 50282496 of 81515168 bytes (61.7%,  2.1min remaining)
Downloaded 50814976 of 81515168 bytes (62.3%,  2.0min remaining)
Downloaded 51068928 of 81515168 bytes (62.6%,  2.0min remaining)
Downloaded 51634176 of 81515168 bytes (63.3%,  2.0min remaining)
Downloaded 52641792 of 81515168 bytes (64.6%,  1.9min remaining)
Downloaded 52690944 of 81515168 bytes (64.6%,  1.9min remaining)
Downloaded 53182464 of 81515168 bytes (65.2%,  1.8min remaining)
Downloaded 53469184 of 81515168 bytes (65.6%,  1.8min remaining)
Downloaded 53559296 of 81515168 bytes (65.7%,  1.8min remaining)
Downloaded 53854208 of 81515168 bytes (66.1%,  1.8min remaining)
Downloaded 54009856 of 81515168 bytes (66.3%,  1.8min remaining)
Downloaded 54378496 of 81515168 bytes (66.7%,  1.8min remaining)
Downloaded 54697984 of 81515168 bytes (67.1%,  1.7min remaining)
Downloaded 54853632 of 81515168 bytes (67.3%,  1.7min remaining)
Downloaded 55296000 of 81515168 bytes (67.8%,  1.7min remaining)
Downloaded 55582720 of 81515168 bytes (68.2%,  1.7min remaining)
Downloaded 56033280 of 81515168 bytes (68.7%,  1.7min remaining)
Downloaded 56467456 of 81515168 bytes (69.3%,  1.6min remaining)
Downloaded 56803328 of 81515168 bytes (69.7%,  1.6min remaining)
Downloaded 57098240 of 81515168 bytes (70.0%,  1.6min remaining)
Downloaded 57286656 of 81515168 bytes (70.3%,  1.6min remaining)
Downloaded 57458688 of 81515168 bytes (70.5%,  1.6min remaining)
Downloaded 57802752 of 81515168 bytes (70.9%,  1.5min remaining)
Downloaded 58163200 of 81515168 bytes (71.4%,  1.5min remaining)
Downloaded 58433536 of 81515168 bytes (71.7%,  1.5min remaining)
Downloaded 58630144 of 81515168 bytes (71.9%,  1.5min remaining)
Downloaded 58925056 of 81515168 bytes (72.3%,  1.5min remaining)
Downloaded 59154432 of 81515168 bytes (72.6%,  1.5min remaining)
Downloaded 59195392 of 81515168 bytes (72.6%,  1.5min remaining)
Downloaded 59654144 of 81515168 bytes (73.2%,  1.4min remaining)
Downloaded 60104704 of 81515168 bytes (73.7%,  1.4min remaining)
Downloaded 60645376 of 81515168 bytes (74.4%,  1.4min remaining)
Downloaded 60850176 of 81515168 bytes (74.6%,  1.3min remaining)
Downloaded 61095936 of 81515168 bytes (75.0%,  1.3min remaining)
Downloaded 61538304 of 81515168 bytes (75.5%,  1.3min remaining)
Downloaded 61677568 of 81515168 bytes (75.7%,  1.3min remaining)
Downloaded 61931520 of 81515168 bytes (76.0%,  1.3min remaining)
Downloaded 62169088 of 81515168 bytes (76.3%,  1.3min remaining)
Downloaded 62668800 of 81515168 bytes (76.9%,  1.2min remaining)
Downloaded 62898176 of 81515168 bytes (77.2%,  1.2min remaining)
Downloaded 63062016 of 81515168 bytes (77.4%,  1.2min remaining)
Downloaded 63676416 of 81515168 bytes (78.1%,  1.2min remaining)
Downloaded 64126976 of 81515168 bytes (78.7%,  1.1min remaining)
Downloaded 64929792 of 81515168 bytes (79.7%,  1.1min remaining)
Downloaded 65241088 of 81515168 bytes (80.0%,  1.0min remaining)
Downloaded 66011136 of 81515168 bytes (81.0%,   59.5s remaining)
Downloaded 66453504 of 81515168 bytes (81.5%,   57.7s remaining)
Downloaded 66699264 of 81515168 bytes (81.8%,   56.7s remaining)
Downloaded 66846720 of 81515168 bytes (82.0%,   56.4s remaining)
Downloaded 67043328 of 81515168 bytes (82.2%,   55.7s remaining)
Downloaded 67289088 of 81515168 bytes (82.5%,   54.8s remaining)
Downloaded 67477504 of 81515168 bytes (82.8%,   54.1s remaining)
Downloaded 67878912 of 81515168 bytes (83.3%,   52.5s remaining)
Downloaded 68247552 of 81515168 bytes (83.7%,   51.1s remaining)
Downloaded 68313088 of 81515168 bytes (83.8%,   51.1s remaining)
Downloaded 68468736 of 81515168 bytes (84.0%,   50.7s remaining)
Downloaded 68739072 of 81515168 bytes (84.3%,   49.6s remaining)
Downloaded 68886528 of 81515168 bytes (84.5%,   49.1s remaining)
Downloaded 69304320 of 81515168 bytes (85.0%,   47.5s remaining)
Downloaded 69623808 of 81515168 bytes (85.4%,   46.3s remaining)
Downloaded 69779456 of 81515168 bytes (85.6%,   45.7s remaining)
Downloaded 69869568 of 81515168 bytes (85.7%,   45.5s remaining)
Downloaded 70090752 of 81515168 bytes (86.0%,   44.7s remaining)
Downloaded 70565888 of 81515168 bytes (86.6%,   42.9s remaining)
Downloaded 70828032 of 81515168 bytes (86.9%,   41.9s remaining)
Downloaded 71294976 of 81515168 bytes (87.5%,   39.9s remaining)
Downloaded 71540736 of 81515168 bytes (87.8%,   39.0s remaining)
Downloaded 71983104 of 81515168 bytes (88.3%,   37.2s remaining)
Downloaded 72228864 of 81515168 bytes (88.6%,   36.2s remaining)
Downloaded 72384512 of 81515168 bytes (88.8%,   35.7s remaining)
Downloaded 73072640 of 81515168 bytes (89.6%,   32.8s remaining)
Downloaded 73408512 of 81515168 bytes (90.1%,   31.6s remaining)
Downloaded 73818112 of 81515168 bytes (90.6%,   29.9s remaining)
Downloaded 74006528 of 81515168 bytes (90.8%,   29.2s remaining)
Downloaded 74407936 of 81515168 bytes (91.3%,   27.7s remaining)
Downloaded 74711040 of 81515168 bytes (91.7%,   26.5s remaining)
Downloaded 74809344 of 81515168 bytes (91.8%,   26.2s remaining)
Downloaded 75079680 of 81515168 bytes (92.1%,   25.2s remaining)
Downloaded 75366400 of 81515168 bytes (92.5%,   24.0s remaining)
Downloaded 75923456 of 81515168 bytes (93.1%,   21.8s remaining)
Downloaded 76423168 of 81515168 bytes (93.8%,   19.8s remaining)
Downloaded 76677120 of 81515168 bytes (94.1%,   18.8s remaining)
Downloaded 76996608 of 81515168 bytes (94.5%,   17.5s remaining)
Downloaded 77365248 of 81515168 bytes (94.9%,   16.1s remaining)
Downloaded 77856768 of 81515168 bytes (95.5%,   14.1s remaining)
Downloaded 78594048 of 81515168 bytes (96.4%,   11.2s remaining)
Downloaded 78962688 of 81515168 bytes (96.9%,    9.8s remaining)
Downloaded 79282176 of 81515168 bytes (97.3%,    8.6s remaining)
Downloaded 79478784 of 81515168 bytes (97.5%,    7.8s remaining)
Downloaded 79773696 of 81515168 bytes (97.9%,    6.7s remaining)
Downloaded 80216064 of 81515168 bytes (98.4%,    5.0s remaining)
Downloaded 80461824 of 81515168 bytes (98.7%,    4.1s remaining)
Downloaded 80658432 of 81515168 bytes (98.9%,    3.3s remaining)
Downloaded 81002496 of 81515168 bytes (99.4%,    2.0s remaining)
Downloaded 81379328 of 81515168 bytes (99.8%,    0.5s remaining) ...done. (315 seconds, 5 min)
Extracting data from /home/circleci/nilearn_data/fiac_nilearn.glm/nipy-data-0.2.tar.gz..... done.
</pre></div>
</div>
<p>Create a mean image for plotting purpose</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img" title="nilearn.image.mean_img" class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"><span class="n">mean_img</span></a>
<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img" title="nilearn.image.mean_img" class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"><span class="n">mean_img</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>The design matrices were pre-computed, we simply put them in a list of
DataFrames</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_files</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;design_matrix1&#39;</span><span class="p">],</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;design_matrix2&#39;</span><span class="p">]]</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class"><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="numpy.load" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="n">df</span><span class="p">)[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_files</span></a><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="glm-estimation">
<h2><span class="section-number">9.5.2.2. </span>GLM estimation<a class="headerlink" href="#glm-estimation" title="Permalink to this headline">¶</a></h2>
<p>GLM specification. Note that the mask was provided in the dataset.
So we use it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"><span class="n">FirstLevelModel</span></a>
<a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"><span class="n">FirstLevelModel</span></a><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">],</span> <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                           <span class="n">minimize_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute fixed effects of the two runs and compute related images
For this, we first define the contrasts as we would do for a single session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3.8/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a> <span class="o">=</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_val</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack" title="numpy.hstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">(([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_columns</span></a> <span class="o">-</span> <span class="mi">4</span><span class="p">)))</span>
</pre></div>
</div>
<p>Statistics for the first session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">129</span><span class="p">,</span> <span class="o">-</span><span class="mi">126</span><span class="p">,</span> <span class="mi">49</span><span class="p">]</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a> <span class="o">=</span> <span class="s1">&#39;DSt_minus_SSt&#39;</span>

<a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit" title="nilearn.glm.first_level.FirstLevelModel.fit" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.compute_contrast" title="nilearn.glm.first_level.FirstLevelModel.compute_contrast" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">compute_contrast</span></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_val</span></a><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">],</span>
    <span class="n">bg_img</span><span class="o">=</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, first session&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_fixed_effects_001.png" srcset="../../_images/sphx_glr_plot_fixed_effects_001.png" alt="plot fixed effects" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7f1a9a287af0&gt;
</pre></div>
</div>
<p>Statistics for the second session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel" title="nilearn.glm.first_level.FirstLevelModel" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit" title="nilearn.glm.first_level.FirstLevelModel.fit" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmri_img</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">design_matrices</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.compute_contrast" title="nilearn.glm.first_level.FirstLevelModel.compute_contrast" class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"><span class="n">fmri_glm</span><span class="o">.</span><span class="n">compute_contrast</span></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_val</span></a><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">],</span>
    <span class="n">bg_img</span><span class="o">=</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, second session&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_fixed_effects_002.png" srcset="../../_images/sphx_glr_plot_fixed_effects_002.png" alt="plot fixed effects" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7f1a9d7a8ee0&gt;
</pre></div>
</div>
<p>Fixed effects statistics</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.glm.contrasts</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.glm.compute_fixed_effects.html#nilearn.glm.compute_fixed_effects" title="nilearn.glm.compute_fixed_effects" class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"><span class="n">compute_fixed_effects</span></a>

<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_imgs</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;effect_size&#39;</span><span class="p">],</span>
                 <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;effect_size&#39;</span><span class="p">]]</span>
<a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variance_imgs</span></a> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;effect_variance&#39;</span><span class="p">],</span>
                 <a href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;effect_variance&#39;</span><span class="p">]]</span>

<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_contrast</span></a><span class="p">,</span> <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_variance</span></a><span class="p">,</span> <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_stat</span></a> <span class="o">=</span> <a href="../../modules/generated/nilearn.glm.compute_fixed_effects.html#nilearn.glm.compute_fixed_effects" title="nilearn.glm.compute_fixed_effects" class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"><span class="n">compute_fixed_effects</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_imgs</span></a><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">variance_imgs</span></a><span class="p">,</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch" class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">])</span>
<a href="../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fixed_fx_stat</span></a><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mean_img_</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="o">=</span><a href="https://docs.python.org/3.8/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cut_coords</span></a><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, fixed effects&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3.8/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_fixed_effects_003.png" srcset="../../_images/sphx_glr_plot_fixed_effects_003.png" alt="plot fixed effects" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7f1a9b122b20&gt;
</pre></div>
</div>
<p>Not unexpectedly, the fixed effects version displays higher peaks than the
input sessions. Computing fixed effects enhances the signal-to-noise ratio of
the resulting brain maps
Note however that, technically, the output maps of the fixed effects map is a
t statistic (not a z statistic)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show" title="nilearn.plotting.show" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plotting</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 5 minutes  30.986 seconds)</p>
<p><strong>Estimated memory usage:</strong>  469 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-04-glm-first-level-plot-fixed-effects-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/nilearn/nilearn.github.io/main?filepath=examples/auto_examples/04_glm_first_level/plot_fixed_effects.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo3.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d2b4e3e9a76e840cd4c542019b17053c/plot_fixed_effects.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_fixed_effects.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/30c60aaeed5034b71966151d9b233e9c/plot_fixed_effects.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_fixed_effects.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">9.5.2. Example of explicit fixed effects fMRI model fitting</a><ul>
<li><a class="reference internal" href="#prepare-data-and-analysis-parameters">9.5.2.1. Prepare data and analysis parameters</a></li>
<li><a class="reference internal" href="#glm-estimation">9.5.2.2. GLM estimation</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="plot_write_events_file.html"
                          title="previous chapter"><span class="section-number">9.5.1. </span>Generate an events.tsv file for the NeuroSpin localizer task</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plot_adhd_dmn.html"
                          title="next chapter"><span class="section-number">9.5.3. </span>Default Mode Network extraction of AHDH dataset</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
            &copy; The nilearn developers 2010-2022.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.5.0.
        <span style="padding-left: 5ex;">
          <a href="../../_sources/auto_examples/04_glm_first_level/plot_fixed_effects.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>