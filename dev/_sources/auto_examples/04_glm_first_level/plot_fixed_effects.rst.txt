
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/04_glm_first_level/plot_fixed_effects.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_04_glm_first_level_plot_fixed_effects.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_04_glm_first_level_plot_fixed_effects.py:

Example of explicit fixed effects fMRI model fitting
====================================================

This example illustrates how to run a fixed effects model based on
pre-computed statistics. This is helpful when the initial models
have to be fit separately.

For details on the data, please see:

Dehaene-Lambertz G, Dehaene S, Anton JL, Campagne A, Ciuciu P, Dehaene
G, Denghien I, Jobert A, LeBihan D, Sigman M, Pallier C, Poline
JB. Functional segregation of cortical language areas by sentence
repetition. Hum Brain Mapp. 2006: 27:360--371.
http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11

Please see `Simple example of two-session :term:`fMRI` model fitting
<https://nistats.github.io/auto_examples/02_first_levels/plot_fiac_analysis.html>`_
example for details.  The main difference is that
the fixed-effects model is run explicitly here,
after GLM fitting on two sessions.

.. GENERATED FROM PYTHON SOURCE LINES 25-29

Prepare data and analysis parameters
--------------------------------------

Inspecting 'data', we note that there are two sessions

.. GENERATED FROM PYTHON SOURCE LINES 29-34

.. code-block:: default


    from nilearn.datasets import func
    data = func.fetch_fiac_first_level()
    fmri_img = [data['func1'], data['func2']]





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    Dataset created in /home/circleci/nilearn_data/fiac_nilearn.glm

    Missing functional scan for session 1.
    Data absent, downloading...
    Downloading data from http://nipy.sourceforge.net/data-packages/nipy-data-0.2.tar.gz ...
    Downloaded 524288 of 81515168 bytes (0.6%,  2.6min remaining)    Downloaded 958464 of 81515168 bytes (1.2%,  3.3min remaining)    Downloaded 1155072 of 81515168 bytes (1.4%,  5.5min remaining)    Downloaded 1310720 of 81515168 bytes (1.6%,  5.9min remaining)    Downloaded 1327104 of 81515168 bytes (1.6%,  6.9min remaining)    Downloaded 1466368 of 81515168 bytes (1.8%,  7.2min remaining)    Downloaded 1671168 of 81515168 bytes (2.1%,  7.2min remaining)    Downloaded 2203648 of 81515168 bytes (2.7%,  6.1min remaining)    Downloaded 2801664 of 81515168 bytes (3.4%,  5.3min remaining)    Downloaded 3293184 of 81515168 bytes (4.0%,  4.9min remaining)    Downloaded 3588096 of 81515168 bytes (4.4%,  4.9min remaining)    Downloaded 3932160 of 81515168 bytes (4.8%,  4.8min remaining)    Downloaded 4399104 of 81515168 bytes (5.4%,  4.6min remaining)    Downloaded 4472832 of 81515168 bytes (5.5%,  4.9min remaining)    Downloaded 4571136 of 81515168 bytes (5.6%,  5.2min remaining)    Downloaded 5005312 of 81515168 bytes (6.1%,  5.0min remaining)    Downloaded 5152768 of 81515168 bytes (6.3%,  5.2min remaining)    Downloaded 5529600 of 81515168 bytes (6.8%,  5.0min remaining)    Downloaded 5701632 of 81515168 bytes (7.0%,  5.1min remaining)    Downloaded 5898240 of 81515168 bytes (7.2%,  5.2min remaining)    Downloaded 6176768 of 81515168 bytes (7.6%,  5.2min remaining)    Downloaded 6815744 of 81515168 bytes (8.4%,  4.9min remaining)    Downloaded 6979584 of 81515168 bytes (8.6%,  5.0min remaining)    Downloaded 7307264 of 81515168 bytes (9.0%,  5.0min remaining)    Downloaded 7831552 of 81515168 bytes (9.6%,  4.8min remaining)    Downloaded 8159232 of 81515168 bytes (10.0%,  4.9min remaining)    Downloaded 8454144 of 81515168 bytes (10.4%,  4.9min remaining)    Downloaded 8921088 of 81515168 bytes (10.9%,  4.7min remaining)    Downloaded 9289728 of 81515168 bytes (11.4%,  4.7min remaining)    Downloaded 9560064 of 81515168 bytes (11.7%,  4.7min remaining)    Downloaded 9732096 of 81515168 bytes (11.9%,  4.7min remaining)    Downloaded 9928704 of 81515168 bytes (12.2%,  4.8min remaining)    Downloaded 10051584 of 81515168 bytes (12.3%,  4.8min remaining)    Downloaded 10534912 of 81515168 bytes (12.9%,  4.7min remaining)    Downloaded 10715136 of 81515168 bytes (13.1%,  4.8min remaining)    Downloaded 11157504 of 81515168 bytes (13.7%,  4.8min remaining)    Downloaded 11419648 of 81515168 bytes (14.0%,  4.7min remaining)    Downloaded 11575296 of 81515168 bytes (14.2%,  4.8min remaining)    Downloaded 11747328 of 81515168 bytes (14.4%,  4.9min remaining)    Downloaded 12255232 of 81515168 bytes (15.0%,  4.8min remaining)    Downloaded 12460032 of 81515168 bytes (15.3%,  4.8min remaining)    Downloaded 12730368 of 81515168 bytes (15.6%,  4.8min remaining)    Downloaded 12779520 of 81515168 bytes (15.7%,  4.9min remaining)    Downloaded 13049856 of 81515168 bytes (16.0%,  4.9min remaining)    Downloaded 13516800 of 81515168 bytes (16.6%,  4.8min remaining)    Downloaded 14057472 of 81515168 bytes (17.2%,  4.7min remaining)    Downloaded 14376960 of 81515168 bytes (17.6%,  4.6min remaining)    Downloaded 14794752 of 81515168 bytes (18.1%,  4.6min remaining)    Downloaded 14893056 of 81515168 bytes (18.3%,  4.7min remaining)    Downloaded 15130624 of 81515168 bytes (18.6%,  4.7min remaining)    Downloaded 15335424 of 81515168 bytes (18.8%,  4.7min remaining)    Downloaded 15433728 of 81515168 bytes (18.9%,  4.7min remaining)    Downloaded 16023552 of 81515168 bytes (19.7%,  4.6min remaining)    Downloaded 16646144 of 81515168 bytes (20.4%,  4.5min remaining)    Downloaded 17104896 of 81515168 bytes (21.0%,  4.4min remaining)    Downloaded 17301504 of 81515168 bytes (21.2%,  4.4min remaining)    Downloaded 17547264 of 81515168 bytes (21.5%,  4.4min remaining)    Downloaded 17694720 of 81515168 bytes (21.7%,  4.4min remaining)    Downloaded 17776640 of 81515168 bytes (21.8%,  4.6min remaining)    Downloaded 18358272 of 81515168 bytes (22.5%,  4.5min remaining)    Downloaded 18849792 of 81515168 bytes (23.1%,  4.4min remaining)    Downloaded 19259392 of 81515168 bytes (23.6%,  4.3min remaining)    Downloaded 19447808 of 81515168 bytes (23.9%,  4.3min remaining)    Downloaded 19554304 of 81515168 bytes (24.0%,  4.3min remaining)    Downloaded 19701760 of 81515168 bytes (24.2%,  4.4min remaining)    Downloaded 19890176 of 81515168 bytes (24.4%,  4.4min remaining)    Downloaded 20070400 of 81515168 bytes (24.6%,  4.4min remaining)    Downloaded 20283392 of 81515168 bytes (24.9%,  4.4min remaining)    Downloaded 20676608 of 81515168 bytes (25.4%,  4.3min remaining)    Downloaded 20791296 of 81515168 bytes (25.5%,  4.3min remaining)    Downloaded 21315584 of 81515168 bytes (26.1%,  4.2min remaining)    Downloaded 21569536 of 81515168 bytes (26.5%,  4.3min remaining)    Downloaded 21700608 of 81515168 bytes (26.6%,  4.3min remaining)    Downloaded 22110208 of 81515168 bytes (27.1%,  4.3min remaining)    Downloaded 22167552 of 81515168 bytes (27.2%,  4.3min remaining)    Downloaded 22257664 of 81515168 bytes (27.3%,  4.3min remaining)    Downloaded 22413312 of 81515168 bytes (27.5%,  4.3min remaining)    Downloaded 22904832 of 81515168 bytes (28.1%,  4.3min remaining)    Downloaded 23527424 of 81515168 bytes (28.9%,  4.2min remaining)    Downloaded 24084480 of 81515168 bytes (29.5%,  4.1min remaining)    Downloaded 24248320 of 81515168 bytes (29.7%,  4.1min remaining)    Downloaded 24379392 of 81515168 bytes (29.9%,  4.1min remaining)    Downloaded 24707072 of 81515168 bytes (30.3%,  4.1min remaining)    Downloaded 25255936 of 81515168 bytes (31.0%,  4.0min remaining)    Downloaded 25952256 of 81515168 bytes (31.8%,  3.9min remaining)    Downloaded 26345472 of 81515168 bytes (32.3%,  3.8min remaining)    Downloaded 26755072 of 81515168 bytes (32.8%,  3.8min remaining)    Downloaded 27017216 of 81515168 bytes (33.1%,  3.8min remaining)    Downloaded 27541504 of 81515168 bytes (33.8%,  3.7min remaining)    Downloaded 28229632 of 81515168 bytes (34.6%,  3.6min remaining)    Downloaded 28827648 of 81515168 bytes (35.4%,  3.5min remaining)    Downloaded 29040640 of 81515168 bytes (35.6%,  3.5min remaining)    Downloaded 29245440 of 81515168 bytes (35.9%,  3.5min remaining)    Downloaded 29614080 of 81515168 bytes (36.3%,  3.5min remaining)    Downloaded 30113792 of 81515168 bytes (36.9%,  3.4min remaining)    Downloaded 30375936 of 81515168 bytes (37.3%,  3.4min remaining)    Downloaded 30523392 of 81515168 bytes (37.4%,  3.4min remaining)    Downloaded 30965760 of 81515168 bytes (38.0%,  3.3min remaining)    Downloaded 31113216 of 81515168 bytes (38.2%,  3.3min remaining)    Downloaded 31334400 of 81515168 bytes (38.4%,  3.3min remaining)    Downloaded 31719424 of 81515168 bytes (38.9%,  3.3min remaining)    Downloaded 32661504 of 81515168 bytes (40.1%,  3.2min remaining)    Downloaded 33325056 of 81515168 bytes (40.9%,  3.1min remaining)    Downloaded 33751040 of 81515168 bytes (41.4%,  3.1min remaining)    Downloaded 34013184 of 81515168 bytes (41.7%,  3.1min remaining)    Downloaded 34177024 of 81515168 bytes (41.9%,  3.1min remaining)    Downloaded 34308096 of 81515168 bytes (42.1%,  3.1min remaining)    Downloaded 34455552 of 81515168 bytes (42.3%,  3.1min remaining)    Downloaded 34652160 of 81515168 bytes (42.5%,  3.1min remaining)    Downloaded 35086336 of 81515168 bytes (43.0%,  3.1min remaining)    Downloaded 35536896 of 81515168 bytes (43.6%,  3.0min remaining)    Downloaded 35930112 of 81515168 bytes (44.1%,  3.0min remaining)    Downloaded 36454400 of 81515168 bytes (44.7%,  2.9min remaining)    Downloaded 36798464 of 81515168 bytes (45.1%,  2.9min remaining)    Downloaded 37060608 of 81515168 bytes (45.5%,  2.9min remaining)    Downloaded 37232640 of 81515168 bytes (45.7%,  2.9min remaining)    Downloaded 37388288 of 81515168 bytes (45.9%,  2.9min remaining)    Downloaded 37683200 of 81515168 bytes (46.2%,  2.9min remaining)    Downloaded 38133760 of 81515168 bytes (46.8%,  2.8min remaining)    Downloaded 38379520 of 81515168 bytes (47.1%,  2.8min remaining)    Downloaded 38436864 of 81515168 bytes (47.2%,  2.8min remaining)    Downloaded 38617088 of 81515168 bytes (47.4%,  2.8min remaining)    Downloaded 39100416 of 81515168 bytes (48.0%,  2.8min remaining)    Downloaded 39813120 of 81515168 bytes (48.8%,  2.7min remaining)    Downloaded 40230912 of 81515168 bytes (49.4%,  2.7min remaining)    Downloaded 40337408 of 81515168 bytes (49.5%,  2.7min remaining)    Downloaded 40796160 of 81515168 bytes (50.0%,  2.7min remaining)    Downloaded 41140224 of 81515168 bytes (50.5%,  2.6min remaining)    Downloaded 41484288 of 81515168 bytes (50.9%,  2.6min remaining)    Downloaded 41820160 of 81515168 bytes (51.3%,  2.6min remaining)    Downloaded 42049536 of 81515168 bytes (51.6%,  2.6min remaining)    Downloaded 42541056 of 81515168 bytes (52.2%,  2.5min remaining)    Downloaded 42737664 of 81515168 bytes (52.4%,  2.5min remaining)    Downloaded 43106304 of 81515168 bytes (52.9%,  2.5min remaining)    Downloaded 43687936 of 81515168 bytes (53.6%,  2.4min remaining)    Downloaded 43917312 of 81515168 bytes (53.9%,  2.4min remaining)    Downloaded 43982848 of 81515168 bytes (54.0%,  2.4min remaining)    Downloaded 44244992 of 81515168 bytes (54.3%,  2.4min remaining)    Downloaded 44433408 of 81515168 bytes (54.5%,  2.4min remaining)    Downloaded 44580864 of 81515168 bytes (54.7%,  2.4min remaining)    Downloaded 44654592 of 81515168 bytes (54.8%,  2.4min remaining)    Downloaded 44728320 of 81515168 bytes (54.9%,  2.5min remaining)    Downloaded 44974080 of 81515168 bytes (55.2%,  2.4min remaining)    Downloaded 45604864 of 81515168 bytes (55.9%,  2.4min remaining)    Downloaded 45940736 of 81515168 bytes (56.4%,  2.4min remaining)    Downloaded 46243840 of 81515168 bytes (56.7%,  2.4min remaining)    Downloaded 46587904 of 81515168 bytes (57.2%,  2.3min remaining)    Downloaded 46743552 of 81515168 bytes (57.3%,  2.3min remaining)    Downloaded 47161344 of 81515168 bytes (57.9%,  2.3min remaining)    Downloaded 47669248 of 81515168 bytes (58.5%,  2.2min remaining)    Downloaded 47800320 of 81515168 bytes (58.6%,  2.2min remaining)    Downloaded 47972352 of 81515168 bytes (58.9%,  2.2min remaining)    Downloaded 48070656 of 81515168 bytes (59.0%,  2.2min remaining)    Downloaded 48218112 of 81515168 bytes (59.2%,  2.2min remaining)    Downloaded 48594944 of 81515168 bytes (59.6%,  2.2min remaining)    Downloaded 49274880 of 81515168 bytes (60.4%,  2.1min remaining)    Downloaded 49790976 of 81515168 bytes (61.1%,  2.1min remaining)    Downloaded 50167808 of 81515168 bytes (61.5%,  2.1min remaining)    Downloaded 50282496 of 81515168 bytes (61.7%,  2.1min remaining)    Downloaded 50814976 of 81515168 bytes (62.3%,  2.0min remaining)    Downloaded 51068928 of 81515168 bytes (62.6%,  2.0min remaining)    Downloaded 51634176 of 81515168 bytes (63.3%,  2.0min remaining)    Downloaded 52641792 of 81515168 bytes (64.6%,  1.9min remaining)    Downloaded 52690944 of 81515168 bytes (64.6%,  1.9min remaining)    Downloaded 53182464 of 81515168 bytes (65.2%,  1.8min remaining)    Downloaded 53469184 of 81515168 bytes (65.6%,  1.8min remaining)    Downloaded 53559296 of 81515168 bytes (65.7%,  1.8min remaining)    Downloaded 53854208 of 81515168 bytes (66.1%,  1.8min remaining)    Downloaded 54009856 of 81515168 bytes (66.3%,  1.8min remaining)    Downloaded 54378496 of 81515168 bytes (66.7%,  1.8min remaining)    Downloaded 54697984 of 81515168 bytes (67.1%,  1.7min remaining)    Downloaded 54853632 of 81515168 bytes (67.3%,  1.7min remaining)    Downloaded 55296000 of 81515168 bytes (67.8%,  1.7min remaining)    Downloaded 55582720 of 81515168 bytes (68.2%,  1.7min remaining)    Downloaded 56033280 of 81515168 bytes (68.7%,  1.7min remaining)    Downloaded 56467456 of 81515168 bytes (69.3%,  1.6min remaining)    Downloaded 56803328 of 81515168 bytes (69.7%,  1.6min remaining)    Downloaded 57098240 of 81515168 bytes (70.0%,  1.6min remaining)    Downloaded 57286656 of 81515168 bytes (70.3%,  1.6min remaining)    Downloaded 57458688 of 81515168 bytes (70.5%,  1.6min remaining)    Downloaded 57802752 of 81515168 bytes (70.9%,  1.5min remaining)    Downloaded 58163200 of 81515168 bytes (71.4%,  1.5min remaining)    Downloaded 58433536 of 81515168 bytes (71.7%,  1.5min remaining)    Downloaded 58630144 of 81515168 bytes (71.9%,  1.5min remaining)    Downloaded 58925056 of 81515168 bytes (72.3%,  1.5min remaining)    Downloaded 59154432 of 81515168 bytes (72.6%,  1.5min remaining)    Downloaded 59195392 of 81515168 bytes (72.6%,  1.5min remaining)    Downloaded 59654144 of 81515168 bytes (73.2%,  1.4min remaining)    Downloaded 60104704 of 81515168 bytes (73.7%,  1.4min remaining)    Downloaded 60645376 of 81515168 bytes (74.4%,  1.4min remaining)    Downloaded 60850176 of 81515168 bytes (74.6%,  1.3min remaining)    Downloaded 61095936 of 81515168 bytes (75.0%,  1.3min remaining)    Downloaded 61538304 of 81515168 bytes (75.5%,  1.3min remaining)    Downloaded 61677568 of 81515168 bytes (75.7%,  1.3min remaining)    Downloaded 61931520 of 81515168 bytes (76.0%,  1.3min remaining)    Downloaded 62169088 of 81515168 bytes (76.3%,  1.3min remaining)    Downloaded 62668800 of 81515168 bytes (76.9%,  1.2min remaining)    Downloaded 62898176 of 81515168 bytes (77.2%,  1.2min remaining)    Downloaded 63062016 of 81515168 bytes (77.4%,  1.2min remaining)    Downloaded 63676416 of 81515168 bytes (78.1%,  1.2min remaining)    Downloaded 64126976 of 81515168 bytes (78.7%,  1.1min remaining)    Downloaded 64929792 of 81515168 bytes (79.7%,  1.1min remaining)    Downloaded 65241088 of 81515168 bytes (80.0%,  1.0min remaining)    Downloaded 66011136 of 81515168 bytes (81.0%,   59.5s remaining)    Downloaded 66453504 of 81515168 bytes (81.5%,   57.7s remaining)    Downloaded 66699264 of 81515168 bytes (81.8%,   56.7s remaining)    Downloaded 66846720 of 81515168 bytes (82.0%,   56.4s remaining)    Downloaded 67043328 of 81515168 bytes (82.2%,   55.7s remaining)    Downloaded 67289088 of 81515168 bytes (82.5%,   54.8s remaining)    Downloaded 67477504 of 81515168 bytes (82.8%,   54.1s remaining)    Downloaded 67878912 of 81515168 bytes (83.3%,   52.5s remaining)    Downloaded 68247552 of 81515168 bytes (83.7%,   51.1s remaining)    Downloaded 68313088 of 81515168 bytes (83.8%,   51.1s remaining)    Downloaded 68468736 of 81515168 bytes (84.0%,   50.7s remaining)    Downloaded 68739072 of 81515168 bytes (84.3%,   49.6s remaining)    Downloaded 68886528 of 81515168 bytes (84.5%,   49.1s remaining)    Downloaded 69304320 of 81515168 bytes (85.0%,   47.5s remaining)    Downloaded 69623808 of 81515168 bytes (85.4%,   46.3s remaining)    Downloaded 69779456 of 81515168 bytes (85.6%,   45.7s remaining)    Downloaded 69869568 of 81515168 bytes (85.7%,   45.5s remaining)    Downloaded 70090752 of 81515168 bytes (86.0%,   44.7s remaining)    Downloaded 70565888 of 81515168 bytes (86.6%,   42.9s remaining)    Downloaded 70828032 of 81515168 bytes (86.9%,   41.9s remaining)    Downloaded 71294976 of 81515168 bytes (87.5%,   39.9s remaining)    Downloaded 71540736 of 81515168 bytes (87.8%,   39.0s remaining)    Downloaded 71983104 of 81515168 bytes (88.3%,   37.2s remaining)    Downloaded 72228864 of 81515168 bytes (88.6%,   36.2s remaining)    Downloaded 72384512 of 81515168 bytes (88.8%,   35.7s remaining)    Downloaded 73072640 of 81515168 bytes (89.6%,   32.8s remaining)    Downloaded 73408512 of 81515168 bytes (90.1%,   31.6s remaining)    Downloaded 73818112 of 81515168 bytes (90.6%,   29.9s remaining)    Downloaded 74006528 of 81515168 bytes (90.8%,   29.2s remaining)    Downloaded 74407936 of 81515168 bytes (91.3%,   27.7s remaining)    Downloaded 74711040 of 81515168 bytes (91.7%,   26.5s remaining)    Downloaded 74809344 of 81515168 bytes (91.8%,   26.2s remaining)    Downloaded 75079680 of 81515168 bytes (92.1%,   25.2s remaining)    Downloaded 75366400 of 81515168 bytes (92.5%,   24.0s remaining)    Downloaded 75923456 of 81515168 bytes (93.1%,   21.8s remaining)    Downloaded 76423168 of 81515168 bytes (93.8%,   19.8s remaining)    Downloaded 76677120 of 81515168 bytes (94.1%,   18.8s remaining)    Downloaded 76996608 of 81515168 bytes (94.5%,   17.5s remaining)    Downloaded 77365248 of 81515168 bytes (94.9%,   16.1s remaining)    Downloaded 77856768 of 81515168 bytes (95.5%,   14.1s remaining)    Downloaded 78594048 of 81515168 bytes (96.4%,   11.2s remaining)    Downloaded 78962688 of 81515168 bytes (96.9%,    9.8s remaining)    Downloaded 79282176 of 81515168 bytes (97.3%,    8.6s remaining)    Downloaded 79478784 of 81515168 bytes (97.5%,    7.8s remaining)    Downloaded 79773696 of 81515168 bytes (97.9%,    6.7s remaining)    Downloaded 80216064 of 81515168 bytes (98.4%,    5.0s remaining)    Downloaded 80461824 of 81515168 bytes (98.7%,    4.1s remaining)    Downloaded 80658432 of 81515168 bytes (98.9%,    3.3s remaining)    Downloaded 81002496 of 81515168 bytes (99.4%,    2.0s remaining)    Downloaded 81379328 of 81515168 bytes (99.8%,    0.5s remaining) ...done. (315 seconds, 5 min)
    Extracting data from /home/circleci/nilearn_data/fiac_nilearn.glm/nipy-data-0.2.tar.gz..... done.




.. GENERATED FROM PYTHON SOURCE LINES 35-36

Create a mean image for plotting purpose

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: default

    from nilearn.image import mean_img
    mean_img_ = mean_img(fmri_img[0])








.. GENERATED FROM PYTHON SOURCE LINES 40-42

The design matrices were pre-computed, we simply put them in a list of
DataFrames

.. GENERATED FROM PYTHON SOURCE LINES 42-47

.. code-block:: default

    design_files = [data['design_matrix1'], data['design_matrix2']]
    import pandas as pd
    import numpy as np
    design_matrices = [pd.DataFrame(np.load(df)['X']) for df in design_files]








.. GENERATED FROM PYTHON SOURCE LINES 48-52

GLM estimation
----------------------------------
GLM specification. Note that the mask was provided in the dataset.
So we use it.

.. GENERATED FROM PYTHON SOURCE LINES 52-57

.. code-block:: default


    from nilearn.glm.first_level import FirstLevelModel
    fmri_glm = FirstLevelModel(mask_img=data['mask'], smoothing_fwhm=5,
                               minimize_memory=True)








.. GENERATED FROM PYTHON SOURCE LINES 58-60

Compute fixed effects of the two runs and compute related images
For this, we first define the contrasts as we would do for a single session

.. GENERATED FROM PYTHON SOURCE LINES 60-63

.. code-block:: default

    n_columns = design_matrices[0].shape[1]
    contrast_val = np.hstack(([-1, -1, 1, 1], np.zeros(n_columns - 4)))








.. GENERATED FROM PYTHON SOURCE LINES 64-65

Statistics for the first session

.. GENERATED FROM PYTHON SOURCE LINES 65-77

.. code-block:: default

    from nilearn import plotting
    cut_coords = [-129, -126, 49]
    contrast_id = 'DSt_minus_SSt'

    fmri_glm = fmri_glm.fit(fmri_img[0], design_matrices=design_matrices[0])
    summary_statistics_session1 = fmri_glm.compute_contrast(
        contrast_val, output_type='all')
    plotting.plot_stat_map(
        summary_statistics_session1['z_score'],
        bg_img=mean_img_, threshold=3.0, cut_coords=cut_coords,
        title='{0}, first session'.format(contrast_id))




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_fixed_effects_001.png
   :alt: plot fixed effects
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_fixed_effects_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7f1a9a287af0>



.. GENERATED FROM PYTHON SOURCE LINES 78-79

Statistics for the second session

.. GENERATED FROM PYTHON SOURCE LINES 79-88

.. code-block:: default


    fmri_glm = fmri_glm.fit(fmri_img[1], design_matrices=design_matrices[1])
    summary_statistics_session2 = fmri_glm.compute_contrast(
        contrast_val, output_type='all')
    plotting.plot_stat_map(
        summary_statistics_session2['z_score'],
        bg_img=mean_img_, threshold=3.0, cut_coords=cut_coords,
        title='{0}, second session'.format(contrast_id))




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_fixed_effects_002.png
   :alt: plot fixed effects
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_fixed_effects_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7f1a9d7a8ee0>



.. GENERATED FROM PYTHON SOURCE LINES 89-90

Fixed effects statistics

.. GENERATED FROM PYTHON SOURCE LINES 90-103

.. code-block:: default

    from nilearn.glm.contrasts import compute_fixed_effects

    contrast_imgs = [summary_statistics_session1['effect_size'],
                     summary_statistics_session2['effect_size']]
    variance_imgs = [summary_statistics_session1['effect_variance'],
                     summary_statistics_session2['effect_variance']]

    fixed_fx_contrast, fixed_fx_variance, fixed_fx_stat = compute_fixed_effects(
        contrast_imgs, variance_imgs, data['mask'])
    plotting.plot_stat_map(
        fixed_fx_stat, bg_img=mean_img_, threshold=3.0, cut_coords=cut_coords,
        title='{0}, fixed effects'.format(contrast_id))




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_fixed_effects_003.png
   :alt: plot fixed effects
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_fixed_effects_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <nilearn.plotting.displays._slicers.OrthoSlicer object at 0x7f1a9b122b20>



.. GENERATED FROM PYTHON SOURCE LINES 104-109

Not unexpectedly, the fixed effects version displays higher peaks than the
input sessions. Computing fixed effects enhances the signal-to-noise ratio of
the resulting brain maps
Note however that, technically, the output maps of the fixed effects map is a
t statistic (not a z statistic)

.. GENERATED FROM PYTHON SOURCE LINES 109-111

.. code-block:: default


    plotting.show()








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 5 minutes  30.986 seconds)

**Estimated memory usage:**  469 MB


.. _sphx_glr_download_auto_examples_04_glm_first_level_plot_fixed_effects.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/nilearn/nilearn.github.io/main?filepath=examples/auto_examples/04_glm_first_level/plot_fixed_effects.ipynb
      :alt: Launch binder
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_fixed_effects.py <plot_fixed_effects.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_fixed_effects.ipynb <plot_fixed_effects.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
